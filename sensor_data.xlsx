# excel_writer.py
import os
from openpyxl import Workbook, load_workbook

EXCEL_FILE = 'sensor_data.xlsx'

def write_to_excel(sensor_data, prediction):
    # Create file if it doesn't exist
    if not os.path.exists(EXCEL_FILE):
        wb = Workbook()
        ws = wb.active
        ws.append(['Temperature', 'Humidity', 'Vibration', 'Motion', 'Prediction'])
        wb.save(EXCEL_FILE)
    # Open and append data
    wb = load_workbook(EXCEL_FILE)
    ws = wb.active
    ws.append([
        sensor_data.get('temperature'),
        sensor_data.get('humidity'),
        sensor_data.get('vibration'),
        sensor_data.get('motion'),
        prediction
    ])
    wb.save(EXCEL_FILE)
